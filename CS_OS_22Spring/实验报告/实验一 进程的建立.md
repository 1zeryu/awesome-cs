

### **实验一** **进程的建立**

####  【实验目的】

 学会通过基本的 Windows 或者 Linux 进程控制函数，由父进程

创建子进程，并实现父子进程协同工作。

#### 【实验软硬件环境】

 Ubuntu21.04

#### 【实验内容】

 创建两个进程，让子进程读取一个文件，父进程等待子进程读取

完文件后继续执行，实现进程协同工作。

#### 【实验程序及分析】

```c
#include<sys/types.h>
#include<fcntl.h>
#include<sys/wait.h>
#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>
char str[100];
int main() {
	FILE* fp = fopen("test.txt", "r");
	int rc = vfork();
	if (rc < 0) {
	 	fprintf(stderr, "Fork failed\n");
	} else if (rc == 0) {
	 	printf("Child process: rc is : %d;\n", rc);
		fscanf(fp, "%s", str);
		printf("Child process: str %s\n", str);	
		exit(0);
	} else {
	 	int status = 0;
		int ret = waitpid (rc, &status, 0);
	       	if (ret < 0) {
		 	exit(-1);
		} 
		if (WIFEXITED(status)) puts("child exited");	
		printf("Parent process: rc is: %d\n", rc);
	}
	fclose(fp);
	return 0;
}

```

其中test.txt中内容为aaaaaaaaaabbbbbbbbbb

#### 【实验截图】

![2022-05-05 15-17-09屏幕截图](../../../home/yjmstr/图片/2022-05-05 15-17-09屏幕截图.png)

#### 【实验心得体会】

vfork中能够执行的操作有限，使用前需要仔细阅读手册。