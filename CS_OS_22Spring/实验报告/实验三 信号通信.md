## 实验三 信号通信

### 实验题目

信号通信

### 实验目的

利用信号通信机制在父子进程及兄弟进程间进行通信

### 实验软件环境

Ubuntu21.04

### 实验内容

父进程创建一个有名事件，由子进程发送事件信号，父进程获取事件信号后进行相应的处理。

### 实验程序及分析

```c
#include<unistd.h>
#include<signal.h>
#include<wait.h>
#include<stdio.h>

void sigchld_handler(int sig) {
        pid_t pid;
        int status;
        for(; (pid=waitpid(-1, &status, WNOHANG)) > 0;){
                printf("child %d died :%d\n", pid, WEXITSTATUS(status));
                printf("hi, parent process received SIGHLD signal successfully!\n");
        }
        return;
}
void main() {
//      int pid_pr = getpid();
        int pid = fork();
        if (pid == 0) {
                printf("child\n");
                sleep(3);
        } else if (pid > 0) {
                signal(SIGCHLD, sigchld_handler);
                pause();
                return;

        } else {
                printf("fork failed\n");
                exit(-1);
        }
}


```

```c
#include<unistd.h>
#include<signal.h>
#include<stdio.h>
void signal_handler(int sig) {
        printf("received SIGINT signal successed!\n");
        return;
}
void main() {
        int pid = fork();
        if (pid == 0) {
                printf("pid = %d\n", getpid());
                sleep(2);
                printf("after sleep pid = %d\n", getpid());
                sleep(2);
                printf("after second sleep pid = %d\n", getpid());
                exit(0);
        } else if (pid > 0) {
                signal(SIGINT, signal_handler);
                pause();
        }else {
                printf("error");
                exit(-1);
        }
}
~            
```



### 实验截图

![阻塞的](../../../home/yjmstr/.config/Typora/typora-user-images/image-20220506190351648.png)

![非阻塞](../../../home/yjmstr/.config/Typora/typora-user-images/image-20220506191150404.png)

### 实验心得体会

无